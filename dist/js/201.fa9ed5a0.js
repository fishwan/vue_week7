"use strict";(self["webpackChunkvue_week7"]=self["webpackChunkvue_week7"]||[]).push([[201],{201:function(e,a,t){t.r(a),t.d(a,{default:function(){return te}});var l=t(6252),s=t(3577),i=t(9963);const d={class:"row justify-content-between"},r={class:"col-lg-7"},c={class:"float-end"},o=["disabled"],n=(0,l._)("div",{class:"page-title"},"購物車",-1),m={class:"cart"},u=(0,l.uE)('<div class="cart-item-title text-center d-flex"><div class="cart-item-img">購買商品</div><div class="cart-item-body row"><div class="col-4 cart-item-name"></div><div class="col-2 cart-item-sale">單價</div><div class="col-2 cart-item-qua">數量</div><div class="col-2 cart-item-sale">小計</div><div class="col-2 cart-item-delete"></div></div></div>',1),v={key:0,class:"cart-item cart-item--none"},h=(0,l._)("div",{class:"fw-bold text-center"},"購物車目前尚無商品",-1),b=[h],p={key:1},g={class:"cart-item-img"},f={class:"img"},_=["src"],y={class:"cart-item-body row align-items-center"},w={class:"col-12 col-lg-4 cart-item-name"},k={class:"col-12 col-lg-2 cart-item-sale"},C={class:"col-12 col-lg-2 cart-item-qua"},x=["onUpdate:modelValue","onChange","disabled"],D=["value"],V={class:"col-12 col-lg-2 cart-item-subtotal fw-bold"},$={class:"col-1 col-lg-2 cart-item-delete"},q=["onClick","disabled"],U={key:0,class:"spinner-border spinner-border-sm",role:"status"},L=(0,l._)("span",{class:"visually-hidden"},"Loading...",-1),W=[L],I={key:1},z=(0,l._)("i",{class:"bi bi-x"},null,-1),A=[z],E={class:"cart-sale text-end"},O=(0,l.Uk)(" 結帳金額  "),j={class:"is-warning"},H=(0,l._)("small",null,"$",-1),K={class:"col-lg-4"},N=(0,l._)("div",{class:"page-title"},"訂購資訊",-1),Q={class:"mb-3"},S=(0,l._)("label",{for:"Email",class:"form-label"},"Email",-1),T={class:"mb-3"},Y=(0,l._)("label",{for:"Name",class:"form-label"},"收件者姓名",-1),F={class:"mb-3"},M=(0,l._)("label",{for:"Tel",class:"form-label"},"收件者電話",-1),Z={class:"mb-3"},B=(0,l._)("label",{for:"Address",class:"form-label"},"收件者地址",-1),G={class:"mb-3"},J=(0,l._)("label",{for:"Content",class:"form-label"},"備註",-1),P=["disabled"];function R(e,a,t,h,L,z){const R=(0,l.up)("v-field"),X=(0,l.up)("error-message"),ee=(0,l.up)("v-form");return(0,l.wg)(),(0,l.iD)("section",null,[(0,l._)("div",d,[(0,l._)("div",r,[(0,l._)("div",null,[(0,l._)("div",c,[(0,l._)("button",{class:"btn btn-dark",type:"button",onClick:a[0]||(a[0]=(...e)=>z.deleteAllCarts&&z.deleteAllCarts(...e)),disabled:0===L.cartData.carts.length},"清空購物車",8,o)]),n]),(0,l._)("div",m,[u,0===L.cartData.total?((0,l.wg)(),(0,l.iD)("div",v,b)):((0,l.wg)(),(0,l.iD)("div",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(L.cartData.carts,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"cart-item d-flex align-items-center",key:e.id},[(0,l._)("div",g,[(0,l._)("span",f,[(0,l._)("img",{class:"img-fluid",src:e.product.imageUrl,alt:""},null,8,_)])]),(0,l._)("div",y,[(0,l._)("div",w,(0,s.zw)(e.product.title),1),(0,l._)("div",k,"$ "+(0,s.zw)(e.product.price),1),(0,l._)("div",C,[(0,l.wy)((0,l._)("select",{class:"form-select",name:"cartItemQty",id:"cartItemQty","onUpdate:modelValue":a=>e.qty=a,onChange:a=>z.updateCartItem(e),disabled:L.isLoading===e.id},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(10,(a=>(0,l._)("option",{value:a,key:`${a}-${e.id}`},(0,s.zw)(a),9,D))),64))],40,x),[[i.bM,e.qty]])]),(0,l._)("div",V,"$ "+(0,s.zw)(e.total),1),(0,l._)("div",$,[(0,l._)("button",{class:"btn btn-link text-dark fs-4",type:"submit",onClick:a=>z.deleteCartItem(e.id),disabled:L.isLoading===e.id},[L.isLoading===e.id?((0,l.wg)(),(0,l.iD)("div",U,W)):((0,l.wg)(),(0,l.iD)("div",I,A))],8,q)])])])))),128))])),(0,l._)("div",E,[O,(0,l._)("b",j,[H,(0,l.Uk)(" "+(0,s.zw)(L.cartData.total),1)])])])]),(0,l._)("div",K,[N,(0,l.Wm)(ee,{ref:"form",onSubmit:z.sendOrder},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",Q,[S,(0,l.Wm)(R,{name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),id:"Email",modelValue:L.form.user.email,"onUpdate:modelValue":a[1]||(a[1]=e=>L.form.user.email=e),rules:"email|required"},null,8,["class","modelValue"]),(0,l.Wm)(X,{class:"invalid-feedback",name:"email"})]),(0,l._)("div",T,[Y,(0,l.Wm)(R,{name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),id:"Name",modelValue:L.form.user.name,"onUpdate:modelValue":a[2]||(a[2]=e=>L.form.user.name=e),rules:"required"},null,8,["class","modelValue"]),(0,l.Wm)(X,{class:"invalid-feedback",name:"姓名"})]),(0,l._)("div",F,[M,(0,l.Wm)(R,{name:"電話",type:"tel",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),id:"Tel",modelValue:L.form.user.tel,"onUpdate:modelValue":a[3]||(a[3]=e=>L.form.user.tel=e),rules:"required|min:8"},null,8,["class","modelValue"]),(0,l.Wm)(X,{class:"invalid-feedback",name:"電話"})]),(0,l._)("div",Z,[B,(0,l.Wm)(R,{name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),id:"Address",modelValue:L.form.user.address,"onUpdate:modelValue":a[4]||(a[4]=e=>L.form.user.address=e),rules:"required"},null,8,["class","modelValue"]),(0,l.Wm)(X,{class:"invalid-feedback",name:"地址"})]),(0,l._)("div",G,[J,(0,l.wy)((0,l._)("textarea",{class:"form-control",id:"Content",rows:"3","onUpdate:modelValue":a[5]||(a[5]=e=>L.form.message=e)},null,512),[[i.nr,L.form.message]])]),(0,l._)("button",{type:"submit",class:"btn btn-dark w-100",disabled:Object.keys(e).length>0||0===L.cartData.carts.length}," 送出訂購 ",8,P)])),_:1},8,["onSubmit"])])])])}var X={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},cartData:{carts:[]},isLoading:""}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2/api/yuchi-hexschool/cart";this.$http.get(e).then((e=>{this.cartData=e.data.data}))},deleteAllCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/yuchi-hexschool/carts";this.$http.delete(e).then((e=>{alert(e.data.message),this.getCart()}))},deleteCartItem(e){const a=`https://vue3-course-api.hexschool.io/v2/api/yuchi-hexschool/cart/${e}`;this.isLoading=e,this.$http.delete(a).then((e=>{alert(e.data.message),this.getCart(),this.isLoading=""}))},updateCartItem(e){const a={product_id:e.id,qty:e.qty},t=`https://vue3-course-api.hexschool.io/v2/api/yuchi-hexschool/cart/${e.id}`;this.isLoading=e.id,this.$http.put(t,{data:a}).then((e=>{this.getCart(),this.isLoading=""}))},sendOrder(){const e="https://vue3-course-api.hexschool.io/v2/api/yuchi-hexschool/order",a=this.form;this.$http.post(e,{data:a}).then((e=>{alert(e.data.message),this.$refs.form.resetForm(),this.getCart()})).catch((e=>{alert(e.data.message)}))}},mounted(){this.getCart()}},ee=t(3744);const ae=(0,ee.Z)(X,[["render",R]]);var te=ae}}]);
//# sourceMappingURL=201.fa9ed5a0.js.map